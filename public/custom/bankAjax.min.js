$(document).ready(function(){function e(){btn='<span id="lblButton"> SAVE CHANGES</span>',label=' <h1 id="label" class="modal-title align-center p-b-15">UPDATE BANK<a href="javascript:void(0);" class="pull-right" data-dismiss="modal"><i class="mdi-navigation-close"></i></a></h1>',"Save"==$("#btnSave").val()&&(btn='<span id="lblButton"> SAVE</span>',label=' <h1 id="label" class="modal-title align-center p-b-15">NEW ACCREDITED BANK<a href="javascript:void(0);" class="pull-right" data-dismiss="modal"><i class="mdi-navigation-close"></i></a></h1>'),$("#lblButton").replaceWith(btn),$("#label").replaceWith(label)}function a(){title="Record Successfully Updated!","Save"==$("#btnSave").val()&&(title="Record Successfully Stored!"),$.notify(title,"success",{timer:1e3})}xhrPool=[];var t=$("#myTable").DataTable({responsive:!0,processing:!0,serverSide:!0,ajax:dataurl,columns:[{data:"description",name:"description"},{data:"is_active",name:"is_active",searchable:!1},{data:"action",name:"action",orderable:!1,searchable:!1}]});$("#btnAddModal").on("click",function(a){$("#btnSave").val("Save"),e(),$("#myModal").modal("show")}),$("#myList").on("click","#btnEdit",function(){var a=$(this).val();$.get(url+"/"+a+"/edit",function(a){"Deleted"==a?($.notify("The Record has been deleted by another user.","warning"),t.draw()):($("#btnSave").val("Edit"),e(),$("#myId").val(a.id),$("#txtBankDesc").val(a.description),$("#myModal").modal("show"))})}),$("#btnSave").on("click",function(e){if($("#myForm").parsley().isValid()){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="_token"]').attr("content")}}),e.preventDefault();var n=url,l="POST",o=$("#myForm").serialize();"Edit"==$("#btnSave").val()&&(l="PUT",n+="/"+$("#myId").val()),$.ajax({beforeSend:function(e,a){xhrPool.push(e)},type:l,url:n,data:o,success:function(e){t.draw(),a(),$("#myModal").modal("hide")},error:function(e){console.log("Error:",e.responseText);try{$("#txtBankDesc").parsley().removeError("ferror",{updateClass:!1}),$("#txtBankDesc").parsley().addError("ferror",{message:e.responseText,updateClass:!1})}catch(e){}finally{$.each(xhrPool,function(e,a){a.abort()})}}})}}),$("#myList").on("change","#IsActive",function(e){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="_token"]').attr("content")}}),e.preventDefault();var a=$(this).val();$.ajax({url:url+"/softdelete/"+a,type:"PUT",success:function(e){},error:function(e){console.log("Error:",e)}})}),$("#myList").on("click",".deleteRecord",function(e){$("#modalDelete").modal("show"),$("#btnDelete").val($(this).val())}),$("#btnDelete").on("click",function(e){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="_token"]').attr("content")}}),e.preventDefault();var a=$(this).val();$.ajax({url:url+"/"+a,type:"delete",success:function(e){"Deleted"==e?($.notify("The Record has been deleted by another user.","warning"),t.draw()):"true"==e[0]?$.notify(e+" is in use.","warning"):(t.draw(),$.notify(e+"'s record has been deleted successfully.","success")),$("#modalDelete").modal("hide")},error:function(e){console.log("Error:",e)}})}),$(document).on("hidden.bs.modal","#myModal",function(){$("#txtBankDesc").parsley().removeError("ferror",{updateClass:!1}),$("#myForm").trigger("reset"),$("#myForm").parsley().destroy()})});