$(document).ready(function(){function e(){title="Requirement Successfully Updated!","Save"==$("#btnSaveReq").val()&&(title="Requirement Successfully Added!"),$.notify(title,"success")}xhrPool=[];var t=$("#myTable").DataTable({responsive:!0,processing:!0,serverSide:!0,ajax:dataurl,columns:[{data:"code"},{data:"tenant"},{data:"business"},{data:"unit_count"},{data:"action"}]});myId="",$(this).on("click","#btnAddRequirement",function(e){$("#btnSaveReq").val("add"),$("#labelReq").text("ADD REQUIREMENT/S"),$("#buttonReq").text(" ADD"),myId=$(this).val(),$("#idReg").val(myId),req="",$.get(url+"/showRequirements/"+myId,function(e){Object.keys(e).length>0?($("#modalRequirement").modal("show"),$.each(e,function(e,t){req+="<input id='"+t.description+"' name='checkboxReq[]' class='filled-in chk-col-yellow' value='"+t.id+"'' type='checkbox'> <label for='"+t.description+"'>"+t.description+"</label><br>"}),$("#divReq").append(req)):$.notify("No available requirement","error")})}),$(this).on("click","#btnEditRequirement",function(e){$("#btnSaveReq").val("edit"),$("#labelReq").text("EDIT REQUIREMENT/S"),$("#buttonReq").text(" SAVE CHANGES"),myId=$(this).val(),$("#idReg").val(myId),req="",$.get(url+"/showCurrentRequirements/"+myId,function(e){console.log(e),Object.keys(e).length>0?($("#modalRequirement").modal("show"),$.each(e,function(e,t){null==t.busi_type_id?mode=" ":mode="disabled ",req+="<input id='"+t.description+"' name='checkboxReq[]' checked "+mode+" class='filled-in chk-col-yellow' value='"+t.id+"'' type='checkbox'> <label for='"+t.description+"'>"+t.description+"</label><br>"}),$("#divReq").append(req)):$.notify("You haven't added any requirements.","error")})}),$(this).on("click","#btnSaveReq",function(a){if($("#frmRequirement").parsley().isValid()){if(a.preventDefault(),"add"==$(this).val())var n=urlstorereq,o="POST";else if("edit"==$(this).val())var n=urlupdatereq,o="PUT";formData=$("#frmRequirement").serialize(),$.ajax({beforeSend:function(e,t){xhrPool.push(e)},type:o,url:n,data:formData,success:function(a){t.draw(),console.log(a),e(),$("#modalRequirement").modal("hide")},error:function(e){console.log("Error:",e.responseText);try{$("#txtDesc").parsley().removeError("ferror",{updateClass:!1}),$("#txtDesc").parsley().addError("ferror",{message:e.responseText,updateClass:!1})}catch(e){}finally{$.each(xhrPool,function(e,t){t.abort()})}}})}}),$(document).on("hidden.bs.modal","#modalRequirement",function(){$("#divReq").empty()})});