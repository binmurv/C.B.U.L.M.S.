$.fn.editableTableWidget=function(e){"use strict";return $(this).each(function(){var t,i=$.extend(function(){var e=$.extend({},$.fn.editableTableWidget.defaultOptions);return e.editor=e.editor.clone(),e}(),e),n=$(this),r=i.editor.css("position","absolute").hide().appendTo(n.parent()),o=function(e){if((t=n.find("td:focus")).length){if(-1!=$.inArray(t.index()+1,i.preventColumns))return void t.blur();r.val(t.text()).removeClass("error").show().offset(t.offset()).css(t.css(i.cloneProperties)).width(t.width()).height(t.height()).focus(),e&&r.select()}},s=function(){var e,i=r.val(),n=$.Event("change");if(t.text()===i||r.hasClass("error"))return!0;e=t.html(),t.text(i).trigger(n,i),!1===n.result&&t.html(e)},d=function(e,t){return 39===t?e.next("td"):37===t?e.prev("td"):38===t?e.parent().prev().children().eq(e.index()):40===t?e.parent().next().children().eq(e.index()):[]};r.blur(function(){s(),r.hide()}).keydown(function(e){if(13===e.which)s(),r.hide(),t.focus(),e.preventDefault(),e.stopPropagation();else if(27===e.which)r.val(t.text()),e.preventDefault(),e.stopPropagation(),r.hide(),t.focus();else if(9===e.which)t.focus();else if(this.selectionEnd-this.selectionStart===this.value.length){var i=d(t,e.which);i.length>0&&(i.focus(),e.preventDefault(),e.stopPropagation())}}).on("input paste",function(){var e=$.Event("validate");t.trigger(e,r.val()),!1===e.result?r.addClass("error"):r.removeClass("error")}),n.on("click keypress dblclick",o).css("cursor","pointer").keydown(function(e){var t=!0,i=d($(e.target),e.which);i.length>0?i.focus():13===e.which?o(!1):17===e.which||91===e.which||93===e.which?(o(!0),t=!1):t=!1,t&&(e.stopPropagation(),e.preventDefault())}),n.find("td").prop("tabindex",1),$(window).on("resize",function(){r.is(":visible")&&r.offset(t.offset()).width(t.width()).height(t.height())})})},$.fn.editableTableWidget.defaultOptions={cloneProperties:["padding","padding-top","padding-bottom","padding-left","padding-right","text-align","font","font-size","font-family","font-weight","border","border-top","border-bottom","border-left","border-right"],editor:$("<input>")};